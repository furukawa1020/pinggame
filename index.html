<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß∂ „Çè„Åü„Çè„Åü„Éö„É≥„ÇÆ„É≥„Éã„ÉÉ„Éà„ÉØ„Éº„É´„Éâ üß∂</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: radial-gradient(ellipse at center, #F8E6E0, #E8D5C8, #D4C4B0);
            font-family: 'Nunito', sans-serif;
            overflow: hidden;
            user-select: none;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        /* ÊØõÁ≥∏„ÅÆËÉåÊôØ„ÉÜ„ÇØ„Çπ„ÉÅ„É£ */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1) 1px, transparent 1px),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 1px, transparent 1px),
                radial-gradient(circle at 40% 40%, rgba(255,255,255,0.05) 2px, transparent 2px);
            background-size: 50px 50px, 30px 30px, 70px 70px;
            pointer-events: none;
            z-index: 1;
        }
        
        #gameContainer {
            border: 8px solid;
            border-image: linear-gradient(45deg, #8B4513, #D2691E, #CD853F, #DEB887) 1;
            border-radius: 30px;
            box-shadow: 
                0 0 0 4px #F5DEB3,
                0 20px 60px rgba(0,0,0,0.2),
                inset 0 0 0 2px rgba(255,255,255,0.3);
            background: linear-gradient(135deg, #FFF8DC, #F5F5DC);
            position: relative;
            overflow: hidden;
            z-index: 2;
        }
        
        canvas {
            display: block;
            background: 
                radial-gradient(ellipse at 30% 20%, rgba(255,228,196,0.8), transparent 50%),
                radial-gradient(ellipse at 70% 80%, rgba(255,240,245,0.6), transparent 50%),
                linear-gradient(to bottom, #F0F8FF, #E6F3FF, #DDE9F0);
        }
        
        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            border: 3px solid #DEB887;
            border-radius: 20px;
            padding: 15px 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            z-index: 10;
            font-weight: 600;
            color: #8B4513;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 16px;
        }
        
        .stat-icon {
            font-size: 20px;
            margin-right: 8px;
            filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.2));
        }
        
        .stat-value {
            font-weight: 800;
            color: #CD853F;
            min-width: 60px;
            text-align: right;
        }
        
        #title {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(45deg, #8B4513, #D2691E, #CD853F);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
            text-shadow: none;
            z-index: 3;
        }
        
        .control-panel {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 10;
        }
        
        .yarn-button {
            background: linear-gradient(135deg, #FF69B4, #FF1493, #DC143C);
            border: 3px solid #FFF;
            border-radius: 25px;
            padding: 12px 24px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Nunito', sans-serif;
            font-size: 14px;
            box-shadow: 
                0 6px 20px rgba(255,20,147,0.4),
                inset 0 1px 0 rgba(255,255,255,0.3);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .yarn-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .yarn-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 
                0 12px 30px rgba(255,20,147,0.6),
                inset 0 1px 0 rgba(255,255,255,0.4);
        }
        
        .yarn-button:hover::before {
            left: 100%;
        }
        
        .yarn-button:active {
            transform: translateY(-1px) scale(1.02);
        }
        
        .special-button {
            background: linear-gradient(135deg, #FFD700, #FFA500, #FF8C00);
            box-shadow: 
                0 6px 20px rgba(255,215,0,0.4),
                inset 0 1px 0 rgba(255,255,255,0.3);
        }
        
        .special-button:hover {
            box-shadow: 
                0 12px 30px rgba(255,215,0,0.6),
                inset 0 1px 0 rgba(255,255,255,0.4);
        }
        
        .mood-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            border: 3px solid #DEB887;
            border-radius: 20px;
            padding: 12px 16px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            z-index: 10;
        }
        
        .mood-bar {
            width: 120px;
            height: 8px;
            background: #E0E0E0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .mood-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF69B4, #FFB6C1, #FFC0CB);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .settings-panel {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
            z-index: 10;
        }
        
        .mini-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 3px solid #FFF;
            background: linear-gradient(135deg, #87CEEB, #4169E1);
            color: white;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .mini-button:hover {
            transform: translateY(-2px) scale(1.1);
            box-shadow: 0 6px 18px rgba(0,0,0,0.3);
        }
        
        @keyframes yarnFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-10px) rotate(120deg); }
            66% { transform: translateY(-5px) rotate(240deg); }
        }
        
        .floating-yarn {
            position: absolute;
            font-size: 24px;
            animation: yarnFloat 4s ease-in-out infinite;
            pointer-events: none;
            z-index: 5;
        }
        
        /* „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©Âåñ */
        canvas {
            image-rendering: optimizeSpeed;
            image-rendering: -moz-crisp-edges;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: optimize-contrast;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="title">üêß „Å∫„Çì„Åé„Çì„ÅΩ„Çà„ÅΩ„Çà„Éï„Ç°„ÇØ„Éà„É™„Éº üêß</div>
        <div id="ui">
            <div>üêü È≠ö: <span id="fishCount">0</span></div>
            <div>‚≠ê „Çπ„Ç≥„Ç¢: <span id="score">0</span></div>
            <div>üêß „Éö„É≥„ÇÆ„É≥: <span id="penguinCount">3</span></div>
        </div>
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        <button class="cute-button" onclick="addPenguin()">üêß+ „Éö„É≥„ÇÆ„É≥ËøΩÂä†</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // „Ç≤„Éº„É†Áä∂ÊÖã
        let gameState = {
            fish: 0,
            score: 0,
            penguins: [],
            fishItems: [],
            particles: [],
            time: 0
        };
        
        // „Éö„É≥„ÇÆ„É≥„ÇØ„É©„ÇπÔºà„Ç∑„É≥„Éó„É´AIÊê≠ËºâÔºâ
        class Penguin {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.targetX = x;
                this.targetY = y;
                this.speed = 0.5 + Math.random() * 0.5;
                this.size = 25 + Math.random() * 10;
                this.color = this.randomPenguinColor();
                this.state = 'idle'; // idle, moving, working
                this.workTimer = 0;
                this.personalityTimer = Math.random() * 1000;
                this.wobbleOffset = Math.random() * Math.PI * 2;
                this.happiness = 50 + Math.random() * 50;
                this.lastAction = 0;
                this.direction = Math.random() > 0.5 ? 1 : -1;
            }
            
            randomPenguinColor() {
                const colors = ['#2C3E50', '#34495E', '#5D6D7E', '#85929E'];
                return colors[Math.floor(Math.random() * colors.length)];
            }
            
            // „Éö„É≥„ÇÆ„É≥AIÔºö„Ç∑„É≥„Éó„É´„Å™Áä∂ÊÖãÊ©üÊ¢∞
            think() {
                this.personalityTimer++;
                
                // Âü∫Êú¨ÁöÑ„Å™Ë°åÂãïÊ±∫ÂÆöAI
                if (this.state === 'idle') {
                    if (Math.random() < 0.02) { // 2%„ÅÆÁ¢∫Áéá„ÅßË°åÂãïÈñãÂßã
                        if (gameState.fishItems.length > 0 && Math.random() < 0.7) {
                            // È≠ö„ÇíÂèñ„Çä„Å´Ë°å„Åè
                            this.goToNearestFish();
                        } else {
                            // „É©„É≥„ÉÄ„É†„Å´ÁßªÂãï
                            this.setRandomTarget();
                        }
                    }
                } else if (this.state === 'moving') {
                    if (this.reachedTarget()) {
                        this.state = 'working';
                        this.workTimer = 30 + Math.random() * 60;
                    }
                } else if (this.state === 'working') {
                    this.workTimer--;
                    if (this.workTimer <= 0) {
                        this.state = 'idle';
                        this.collectNearbyFish();
                    }
                }
                
                // Âπ∏Á¶èÂ∫¶„ÅÆËá™ÁÑ∂„Å™Â§âÂåñ
                this.happiness += (Math.random() - 0.5) * 0.5;
                this.happiness = Math.max(0, Math.min(100, this.happiness));
            }
            
            goToNearestFish() {
                if (gameState.fishItems.length === 0) return;
                
                let nearest = gameState.fishItems[0];
                let minDist = this.distanceTo(nearest.x, nearest.y);
                
                for (let fish of gameState.fishItems) {
                    let dist = this.distanceTo(fish.x, fish.y);
                    if (dist < minDist) {
                        minDist = dist;
                        nearest = fish;
                    }
                }
                
                this.targetX = nearest.x;
                this.targetY = nearest.y;
                this.state = 'moving';
            }
            
            setRandomTarget() {
                this.targetX = 50 + Math.random() * (canvas.width - 100);
                this.targetY = 50 + Math.random() * (canvas.height - 100);
                this.state = 'moving';
            }
            
            distanceTo(x, y) {
                return Math.sqrt((this.x - x) ** 2 + (this.y - y) ** 2);
            }
            
            reachedTarget() {
                return this.distanceTo(this.targetX, this.targetY) < 5;
            }
            
            collectNearbyFish() {
                for (let i = gameState.fishItems.length - 1; i >= 0; i--) {
                    let fish = gameState.fishItems[i];
                    if (this.distanceTo(fish.x, fish.y) < 40) {
                        gameState.fishItems.splice(i, 1);
                        gameState.fish++;
                        gameState.score += 10;
                        this.happiness += 10;
                        
                        // ÂèØÊÑõ„ÅÑ„Éë„Éº„ÉÜ„Ç£„ÇØ„É´ÂäπÊûú
                        this.createHappyParticles();
                        break;
                    }
                }
            }
            
            createHappyParticles() {
                for (let i = 0; i < 8; i++) {
                    gameState.particles.push({
                        x: this.x,
                        y: this.y - 10,
                        vx: (Math.random() - 0.5) * 4,
                        vy: -Math.random() * 3 - 1,
                        life: 60,
                        maxLife: 60,
                        color: `hsl(${Math.random() * 60 + 300}, 70%, 70%)`
                    });
                }
            }
            
            update() {
                this.think();
                
                // Êªë„Çâ„Åã„Å™ÁßªÂãï
                if (this.state === 'moving') {
                    let dx = this.targetX - this.x;
                    let dy = this.targetY - this.y;
                    this.x += dx * this.speed * 0.1;
                    this.y += dy * this.speed * 0.1;
                    
                    this.direction = dx > 0 ? 1 : -1;
                }
                
                // Â¢ÉÁïå„ÉÅ„Çß„ÉÉ„ÇØ
                this.x = Math.max(this.size, Math.min(canvas.width - this.size, this.x));
                this.y = Math.max(this.size, Math.min(canvas.height - this.size, this.y));
            }
            
            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.scale(this.direction, 1);
                
                // „ÅΩ„Çà„ÅΩ„Çà„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
                let wobble = Math.sin((gameState.time + this.wobbleOffset) * 0.1) * 2;
                ctx.translate(0, wobble);
                
                // ÂΩ±
                ctx.fillStyle = 'rgba(0,0,0,0.2)';
                ctx.beginPath();
                ctx.ellipse(0, this.size + 5, this.size * 0.8, this.size * 0.3, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // ‰Ωì
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.ellipse(0, 0, this.size, this.size * 1.2, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // „ÅäËÖπ
                ctx.fillStyle = '#FFFFFF';
                ctx.beginPath();
                ctx.ellipse(0, 5, this.size * 0.6, this.size * 0.8, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // „Åè„Å°„Å∞„Åó
                ctx.fillStyle = '#FF8C00';
                ctx.beginPath();
                ctx.ellipse(-this.size * 0.3, -5, 8, 5, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // ÁõÆ
                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.arc(-this.size * 0.2, -this.size * 0.2, 4, 0, Math.PI * 2);
                ctx.fill();
                
                // Âπ∏„ÅõÁõÆ
                if (this.happiness > 70) {
                    ctx.strokeStyle = '#000';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.arc(-this.size * 0.2, -this.size * 0.2, 6, 0, Math.PI);
                    ctx.stroke();
                }
                
                // ÂÉç„ÅÑ„Å¶„ÅÑ„ÇãÊôÇ„ÅÆ„Ç®„Éï„Çß„ÇØ„Éà
                if (this.state === 'working') {
                    ctx.fillStyle = '#FFD700';
                    ctx.font = '16px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('üí´', 0, -this.size - 10);
                }
                
                ctx.restore();
            }
        }
        
        // È≠ö„Ç¢„Ç§„ÉÜ„É†„ÇØ„É©„Çπ
        class FishItem {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.size = 15;
                this.bobOffset = Math.random() * Math.PI * 2;
                this.sparkleTimer = Math.random() * 100;
            }
            
            update() {
                this.sparkleTimer++;
                if (this.sparkleTimer > 120) {
                    this.sparkleTimer = 0;
                    // „Åç„Çâ„Åç„Çâ„Ç®„Éï„Çß„ÇØ„Éà
                    gameState.particles.push({
                        x: this.x + (Math.random() - 0.5) * 20,
                        y: this.y + (Math.random() - 0.5) * 20,
                        vx: 0,
                        vy: -0.5,
                        life: 30,
                        maxLife: 30,
                        color: '#87CEEB'
                    });
                }
            }
            
            draw() {
                ctx.save();
                ctx.translate(this.x, this.y + Math.sin((gameState.time + this.bobOffset) * 0.1) * 3);
                
                // È≠ö„ÅÆÂΩ±
                ctx.fillStyle = 'rgba(0,0,0,0.1)';
                ctx.beginPath();
                ctx.ellipse(0, 8, this.size * 0.8, this.size * 0.3, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // È≠ö
                ctx.fillStyle = '#FF6B9D';
                ctx.beginPath();
                ctx.ellipse(0, 0, this.size, this.size * 0.7, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // È≠ö„ÅÆÂ∞ªÂ∞æ
                ctx.fillStyle = '#FF8FB3';
                ctx.beginPath();
                ctx.moveTo(this.size, 0);
                ctx.lineTo(this.size + 8, -6);
                ctx.lineTo(this.size + 8, 6);
                ctx.closePath();
                ctx.fill();
                
                // È≠ö„ÅÆÁõÆ
                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.arc(-this.size * 0.3, -3, 2, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.restore();
            }
        }
        
        // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´„Ç∑„Çπ„ÉÜ„É†
        function updateParticles() {
            for (let i = gameState.particles.length - 1; i >= 0; i--) {
                let p = gameState.particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.life--;
                
                if (p.life <= 0) {
                    gameState.particles.splice(i, 1);
                } else {
                    ctx.save();
                    ctx.globalAlpha = p.life / p.maxLife;
                    ctx.fillStyle = p.color;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, 3, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();
                }
            }
        }
        
        // È≠ö„ÇíËá™ÂãïÁîüÊàê
        function spawnFish() {
            if (Math.random() < 0.02 && gameState.fishItems.length < 10) {
                gameState.fishItems.push(new FishItem(
                    Math.random() * (canvas.width - 100) + 50,
                    Math.random() * (canvas.height - 100) + 50
                ));
            }
        }
        
        // „Éö„É≥„ÇÆ„É≥„ÇíËøΩÂä†
        function addPenguin() {
            if (gameState.penguins.length < 10) {
                gameState.penguins.push(new Penguin(
                    Math.random() * (canvas.width - 100) + 50,
                    Math.random() * (canvas.height - 100) + 50
                ));
                updateUI();
            }
        }
        
        // UIÊõ¥Êñ∞
        function updateUI() {
            document.getElementById('fishCount').textContent = gameState.fish;
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('penguinCount').textContent = gameState.penguins.length;
        }
        
        // ËÉåÊôØÊèèÁîª
        function drawBackground() {
            // Â∑•Â†¥„ÅÆÂ∫ä
            ctx.fillStyle = '#E8F4FD';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Â∑•Â†¥„ÅÆ„É©„Ç§„É≥
            ctx.strokeStyle = 'rgba(74, 144, 226, 0.3)';
            ctx.lineWidth = 2;
            for (let i = 0; i < canvas.width; i += 60) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            for (let i = 0; i < canvas.height; i += 60) {
                ctx.beginPath();
                ctx.moveTo(0, i);
                ctx.lineTo(canvas.width, i);
                ctx.stroke();
            }
        }
        
        // „É°„Ç§„É≥„Ç≤„Éº„É†„É´„Éº„Éó
        function gameLoop() {
            gameState.time++;
            
            // ËÉåÊôØÊèèÁîª
            drawBackground();
            
            // È≠öÁîüÊàê
            spawnFish();
            
            // È≠öÊõ¥Êñ∞„ÉªÊèèÁîª
            for (let fish of gameState.fishItems) {
                fish.update();
                fish.draw();
            }
            
            // „Éö„É≥„ÇÆ„É≥Êõ¥Êñ∞„ÉªÊèèÁîª
            for (let penguin of gameState.penguins) {
                penguin.update();
                penguin.draw();
            }
            
            // „Éë„Éº„ÉÜ„Ç£„ÇØ„É´Êõ¥Êñ∞
            updateParticles();
            
            // UIÊõ¥Êñ∞
            updateUI();
            
            requestAnimationFrame(gameLoop);
        }
        
        // ÂàùÊúüÂåñ
        function init() {
            // ÂàùÊúü„Éö„É≥„ÇÆ„É≥„Çí3ÂåπÈÖçÁΩÆ
            for (let i = 0; i < 3; i++) {
                gameState.penguins.push(new Penguin(
                    100 + i * 200,
                    300 + Math.random() * 100
                ));
            }
            
            // ÂàùÊúüÈ≠ö„ÇíÂ∞ë„ÅóÈÖçÁΩÆ
            for (let i = 0; i < 3; i++) {
                gameState.fishItems.push(new FishItem(
                    Math.random() * (canvas.width - 100) + 50,
                    Math.random() * (canvas.height - 100) + 50
                ));
            }
            
            updateUI();
            gameLoop();
        }
        
        // „Çø„ÉÉ„ÉÅ„Éª„ÇØ„É™„ÉÉ„ÇØ„ÅßÈ≠öËøΩÂä†
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            gameState.fishItems.push(new FishItem(x, y));
        });
        
        // „Ç≤„Éº„É†ÈñãÂßã
        init();
    </script>
</body>
</html>